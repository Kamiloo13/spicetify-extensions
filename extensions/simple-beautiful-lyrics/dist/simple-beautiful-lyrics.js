(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var e=class{constructor(){this.tasks=[],this.subCleanups=[]}AddTask(e,t){t&&this.Clean(t),this.tasks.push({id:t,task:e})}AddSubCleanup(e,t){return this.subCleanups.push({instance:e,id:t}),e}AddObserver(e,t){return this.AddTask(e.disconnect.bind(e),t),e}AddHtml(e,t){return this.AddTask(()=>{e.remove()},t),e}Clean(t){t?(this.tasks=this.tasks.filter(e=>e.id!==t||(e.task(),!1)),this.subCleanups=this.subCleanups.filter(e=>e.id!==t||(e.instance.Clean(),!1))):(this.tasks.forEach(e=>{e.task()}),this.subCleanups.forEach(e=>{e.instance.Clean()}),this.tasks=[])}},t=new e,r=!1;{let e,t;for(var a of document.getElementsByTagName("script"))a.src.includes("simple-beautiful-lyrics.js")&&(a.src.startsWith("https://xpui.app.spotify.com/")?void 0===t?t=a:a.remove():void 0===e?e=a:a.remove());void 0===t?e:(r=!0,void 0!==e&&e.remove(),t)}var s,i=!1,n=Spicetify.Player,o=Spicetify.showNotification,l=Spicetify.Platform,c=l?.History,d=Spicetify.Playbar,u=Spicetify.Snackbar,y=()=>{n=Spicetify.Player,o=Spicetify.showNotification,c=(l=Spicetify.Platform)?.History,d=Spicetify.Playbar,u=Spicetify.Snackbar,void 0!==n&&void 0!==o&&void 0!==l&&void 0!==c&&void 0!==d&&void 0!==u&&(i=!0)},m=class{constructor(){this.listeners=[]}Connect(e){return this.listeners.push(e),()=>this.Disconnect(e)}Disconnect(e){e=this.listeners.indexOf(e);-1<e&&this.listeners.splice(e,1)}Fire(){this.listeners.forEach(e=>e())}},h=new class{constructor(){this.SongChanged=new m,this.Started=!1}Start(){if(!0!==this.Started){this.Started=!0;let e=()=>{this.SongChanged.Fire()};n.addEventListener("songchange",e),t.AddTask(()=>n.removeEventListener("songchange",e)),void 0!==n.data&&e()}}},v=new m,g=1.25,B=40,b=new Map,p=(b.set("Default","brightness(0.5) saturate(2.5)"),b.set("SidePanel","brightness(1) saturate(2.25)"),new Map),f=e=>e.Default,H=async(e,c,d)=>{let i=f(e);return new Promise((e,t)=>{let r=new Image;r.onload=()=>e(r),r.onerror=t,r.src=i}).then(e=>{var t,r=[];for(t of d){var a=t,s=t,i=new OffscreenCanvas(a,s),n=i.getContext("2d"),o=i.width/2,l=i.height/2,l=(n.beginPath(),n.arc(o,l,o,0,2*Math.PI),n.clip(),n.drawImage(e,0,0,a,s),new OffscreenCanvas(Math.round(a*g),Math.round(s*g))),o=l.getContext("2d"),n=l.width/2,a=l.height/2,s=b.get(c)??b.get("Default");o.filter=s+` blur(${B}px)`,o.drawImage(i,n-i.width/2,a-i.height/2),r.push(l.convertToBlob({type:"image/webp",quality:1}))}return Promise.all(r)}).then(t=>{let e=p.get(i);void 0===e&&(e=new Map,p.set(i,e));var r=e.get(c);if(void 0!==r)for(var a of r.values())URL.revokeObjectURL(a);var s=new Map;for(let e=0;e<t.length;e++)s.set(d[e],URL.createObjectURL(t[e]));return s})},N=(e,t,r)=>{e=f(e),e=p.get(e);if(void 0!==e){var a=e.get(t);if(void 0!==a){for(var s of r)if(!1===a.has(s))return;return a}}},C=()=>{var e=n.data.item.metadata,e={Large:e.image_xlarge_url,Big:e.image_large_url,Default:e.image_url,Small:e.image_small_url};e.Default!==s?.Default&&(s=e,v.Fire())},k=()=>s,S=class{static findSetIndex(e){var t=S.ComponentClasses[e];for(let e=0;e<t.length;e++)if(document.body.querySelector("."+t[e]))return void(S.SetIndex=e)}static getComponent(e){return-1===S.SetIndex&&S.findSetIndex(e),document.body.querySelector("."+S.ComponentClasses[e][S.SetIndex])}static checkClassNamesMatch(e,t){-1===S.SetIndex&&S.findSetIndex(t);t=S.ComponentClasses[t][S.SetIndex];return e.contains(t)}},w=S,L=(w.ComponentClasses={FullScreenLyricsBackgroundClass:["lyrics-lyrics-background","o4GE4jG5_QICak2JK_bn","L9xhJOJnV2OL5Chm3Jew"],FullScreenLyricsContainerClass:["lyrics-lyrics-contentWrapper","_Wna90no0o0dta47Heiw","esRByMgBY3TiENAsbDHA"],SidebarLyricsBackgroundClass:["main-nowPlayingView-lyricsGradient","main-nowPlayingView-lyricsGradient","main-nowPlayingView-lyricsGradient"],LyricClass:["lyrics-lyricsContent-lyric","nw6rbs8R08fpPn7RWW2w","NiCdLCpp3o2z6nBrayOn"],UnsyncedLyricClass:["lyrics-lyricsContent-unsynced","SruqsAzX8rUtY2isUZDF","HxblHEsl2WX2yhubfVIc"],HighlightedLyricClass:["lyrics-lyricsContent-highlight","aeO5D7ulxy19q4qNBrkk","MEjuIn9iTBQbnCqHpkoQ"],ActiveLyricClass:["lyrics-lyricsContent-active","EhKgYshvOwpSrTv399Mw","arY01KDGhWNgzlAHlhpd"]},w.SetIndex=-1,w),A=[],x=function(e,t){return e=setTimeout(()=>{t()},1e3*e),A.push(e),function(e){clearTimeout(e);e=A.indexOf(e);-1<e&&A.splice(e,1)}.bind(null,e)},F=!1,_=[2,3],O=["lyrics-background-color","lyrics-background-back","lyrics-background-back-center"],U=[0,0,1],W=.25,M=t.AddSubCleanup(new e,"LiveMainBackgrounds"),E=t.AddSubCleanup(new e,"LiveSidebarBackgrounds"),q=e=>{let i=M.AddHtml(document.createElement("div")),n=(i.classList.add("lyrics-background-container"),[]);for(var t of O){var r=M.AddHtml(document.createElement("img"));r.classList.add(t),i.appendChild(r),n.push(r)}let o;if(F){let a=[],s=e=>{for(var[t,r]of n.entries())r.src=e?e.get(a[U[t]])??"MISSING":""},e=(o=()=>{let t=k();if(void 0===t)return s();for(var e of n)e.src=t.Default;var r=N(t,"LyricsPlusFullScreen",a);void 0===r?H(t,"LyricsPlusFullScreen",a).then(e=>{t===k()&&s(e)}):s(r)},()=>{var e,t=i.offsetWidth,r=[];for(e of _)r.push(Math.floor(t*e));a=r,o()});M.AddObserver(new ResizeObserver(()=>M.AddTask(x(W,e),"ContainerResize"))).observe(i),e()}else o=()=>{var e,t=k()?.Default??"";for(e of n)e.src=t};M.AddTask(v.Connect(o)),o();var a=()=>{e.classList.contains("lyrics-background")||e.classList.add("lyrics-background")};a(),M.AddObserver(new MutationObserver(a)).observe(e,{attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1}),e.prepend(i),M.AddTask(()=>e.classList.remove("lyrics-background"))},G=e=>{var t,r=E.AddHtml(document.createElement("div"));r.classList.add("lyrics-background-container"),r.style.zIndex="-1";let a=[];for(t of O){var s=E.AddHtml(document.createElement("img"));s.classList.add(t),r.appendChild(s),a.push(s)}var i=()=>{var e,t=k()?.Default??"";for(e of a)e.src=t},i=(E.AddTask(v.Connect(i)),i(),()=>{e.classList.contains("lyrics-background")||e.classList.add("lyrics-background")});e.style.position="relative",i(),E.AddObserver(new MutationObserver(i)).observe(e,{attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1}),e.prepend(r),E.AddTask(()=>{e.classList.remove("lyrics-background"),e.style.position=""})},P=null,T=null,V=()=>{var e=L.getComponent("FullScreenLyricsBackgroundClass");P!==e&&(null===e?(P=null,M.Clean()):((P=e).style.background="linear-gradient(90deg, #0a0a0a8a, #0000)",q(e?.parentElement?.parentElement?.parentElement?.parentElement?.parentElement?.parentElement?.querySelector(".under-main-view"))))},Y=()=>{var e=L.getComponent("SidebarLyricsBackgroundClass");T!==e&&(null===e?(T=null,E.Clean()):G(T=e))},D=()=>{V(),Y()},j=4,K=.5,J=.25,Q=.005,I=t.AddSubCleanup(new e,"Lyrics"),X=s=>{let n=new Map,i=0,o=(e,t)=>{e.style.fontSize="Active"==t.State?i+K+"rem":""},e=()=>{let t=0;for(var[e,r]of n){e=e.classList;L.checkClassNamesMatch(e,"ActiveLyricClass")?(r.State="Active",t=r.LayoutOrder):L.checkClassNamesMatch(e,"UnsyncedLyricClass")?r.State="Unsynced":L.checkClassNamesMatch(e,"HighlightedLyricClass")?r.State="Sung":r.State="Unsung"}for(var[a,s]of n){var i="Active"===s.State||"Unsynced"===s.State;let e;e=i||t<=1?0:Math.min(Math.abs(s.LayoutOrder-t),j);i=i?"var(--lyrics-color-active)":"Sung"===s.State?"var(--lyrics-color-passed)":"var(--lyrics-color-inactive)";o(a,s),a.style.color="transparent",a.style.textShadow=`0 0 ${e}px `+i}},t=()=>{var e,t,r=getComputedStyle(s),a=getComputedStyle(document.documentElement),r=parseFloat(r.fontSize),a=parseFloat(a.fontSize);i=r/a;for([e,t]of n)o(e,t)};var r,a,l;for(r of s.childNodes)r instanceof HTMLDivElement&&L.checkClassNamesMatch(r.classList,"LyricClass")&&(a=r,l=void 0,l=Array.from(s.children).indexOf(a),I.AddObserver(new MutationObserver(()=>I.AddTask(x(Q,e),"LyricUpdate"))).observe(a,{attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1}),n.set(a,{LayoutOrder:l,State:"Unsung"}));I.AddObserver(new ResizeObserver(()=>I.AddTask(x(J,t),"ContainerResize"))).observe(document.body),t(),e()},R=null,z=()=>{var e=L.getComponent("FullScreenLyricsContainerClass");R!==e&&(R=null,I.Clean(),e)&&X(R=e)},$=async function(){for(;!i&&!y();)await new Promise(e=>setTimeout(e,100));var e;r||(t.AddTask(h.SongChanged.Connect(C)),C(),h.Start(),t.AddObserver(new MutationObserver(()=>{D(),z()})).observe(document.body,{attributes:!1,childList:!0,subtree:!0}),(e=document.querySelector("#lyrics-cinema"))?.style.setProperty("grid-area","main-view / main-view / main-view / right-sidebar"),e?.style.setProperty("overflow","hidden"),D(),t.AddTask(h.SongChanged.Connect(()=>R=null)),z())};(async()=>{await $()})(),(async()=>{var e;document.getElementById("simpleDbeautifulDlyrics")||((e=document.createElement("style")).id="simpleDbeautifulDlyrics",e.textContent=String.raw`
  .lyrics-lyricsContent-lyric:hover{text-shadow:0 0 0 var(--lyrics-color-active)!important}.lyrics-lyricsContent-lyric{--lyrics-color-inactive:rgb(240 240 240 / 51%)!important}.nw6rbs8R08fpPn7RWW2w:hover{text-shadow:0 0 0 var(--lyrics-color-active)!important}.nw6rbs8R08fpPn7RWW2w{--lyrics-color-inactive:rgb(240 240 240 / 51%)!important}.NiCdLCpp3o2z6nBrayOn:hover{text-shadow:0 0 0 var(--lyrics-color-active)!important}.NiCdLCpp3o2z6nBrayOn{--lyrics-color-inactive:rgb(240 240 240 / 51%)!important}.lyrics-lyricsContent-active{margin-top:.25em;margin-bottom:.25em}.EhKgYshvOwpSrTv399Mw{margin-top:.25em;margin-bottom:.25em}.arY01KDGhWNgzlAHlhpd{margin-top:.25em;margin-bottom:.25em}.Root__main-view:has(.lyrics-background) .os-scrollbar,.os-host:has(.lyrics-background) .os-scrollbar{padding:5px}.Root__main-view:has(.lyrics-background) .os-scrollbar .os-scrollbar-handle,.os-host:has(.lyrics-background) .os-scrollbar .os-scrollbar-handle{mix-blend-mode:overlay;background-color:rgba(252,249,249,.117)!important}.lyrics-background{overflow:hidden;position:static}.lyrics-background-container{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden;filter:saturate(1.5) brightness(.8)}.lyrics-background-back,.lyrics-background-back-center,.lyrics-background-color{position:absolute;width:200%;animation:rotate 35s linear infinite;filter:blur(40px);border-radius:100em}.lyrics-background-color{right:0;top:0;z-index:10}.lyrics-background-back{left:0;bottom:0;z-index:1;animation-direction:reverse}.lyrics-background-back-center{z-index:0;width:300%;right:-50%;top:-20%;animation-direction:reverse}@keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}:root{--beautiful-lyrics-random-degree:258deg}@keyframes rotate{0%{transform:rotate(var(--beautiful-lyrics-random-degree))}100%{transform:rotate(calc(var(--beautiful-lyrics-random-degree) + 360deg))}}.main-nowPlayingView-lyricsContent .lyrics-lyricsContent-lyric{font-weight:700}.lyrics-lyricsContent-lyric:hover{text-decoration:none!important}
      `.trim(),document.head.appendChild(e))})()})();