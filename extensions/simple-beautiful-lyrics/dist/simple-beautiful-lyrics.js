(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var e=class{constructor(){this.tasks=[],this.subCleanups=[]}AddTask(e,t){t&&this.Clean(t),this.tasks.push({id:t,task:e})}AddSubCleanup(e,t){return this.subCleanups.push({instance:e,id:t}),e}AddObserver(e,t){return this.AddTask(e.disconnect.bind(e),t),e}AddHtml(e,t){return this.AddTask(()=>{e.remove()},t),e}Clean(t){t?(this.tasks=this.tasks.filter(e=>e.id!==t||(e.task(),!1)),this.subCleanups=this.subCleanups.filter(e=>e.id!==t||(e.instance.Clean(),!1))):(this.tasks.forEach(e=>{e.task()}),this.subCleanups.forEach(e=>{e.instance.Clean()}),this.tasks=[])}},t=new e,r=!1;{let e,t;for(var a of document.getElementsByTagName("script"))a.src.includes("simple-beautiful-lyrics.js")&&(a.src.startsWith("https://xpui.app.spotify.com/")?void 0===t?t=a:a.remove():void 0===e?e=a:a.remove());void 0===t?e:(r=!0,void 0!==e&&e.remove(),t)}var i,s=!1,n=Spicetify.Player,o=Spicetify.showNotification,l=Spicetify.Platform,c=l?.History,d=Spicetify.Playbar,u=Spicetify.Snackbar,f=()=>{n=Spicetify.Player,o=Spicetify.showNotification,c=(l=Spicetify.Platform)?.History,d=Spicetify.Playbar,u=Spicetify.Snackbar,void 0!==n&&void 0!==o&&void 0!==l&&void 0!==c&&void 0!==d&&void 0!==u&&(s=!0)},y=class{constructor(){this.listeners=[]}Connect(e){return this.listeners.push(e),()=>this.Disconnect(e)}Disconnect(e){e=this.listeners.indexOf(e);-1<e&&this.listeners.splice(e,1)}Fire(){this.listeners.forEach(e=>e())}},m=new class{constructor(){this.SongChanged=new y,this.Started=!1}Start(){if(!0!==this.Started){this.Started=!0;let e=()=>{this.SongChanged.Fire()};n.addEventListener("songchange",e),t.AddTask(()=>n.removeEventListener("songchange",e)),void 0!==n.data&&e()}}},h=new y,v=1.25,z=40,g=new Map,b=(g.set("Default","brightness(0.5) saturate(2.5)"),g.set("SidePanel","brightness(1) saturate(2.25)"),new Map),p=e=>e.Default,H=async(e,c,d)=>{let s=p(e);return new Promise((e,t)=>{let r=new Image;r.onload=()=>e(r),r.onerror=t,r.src=s}).then(e=>{var t,r=[];for(t of d){var a=t,i=t,s=new OffscreenCanvas(a,i),n=s.getContext("2d"),o=s.width/2,l=s.height/2,l=(n.beginPath(),n.arc(o,l,o,0,2*Math.PI),n.clip(),n.drawImage(e,0,0,a,i),new OffscreenCanvas(Math.round(a*v),Math.round(i*v))),o=l.getContext("2d"),n=l.width/2,a=l.height/2,i=g.get(c)??g.get("Default");o.filter=i+` blur(${z}px)`,o.drawImage(s,n-s.width/2,a-s.height/2),r.push(l.convertToBlob({type:"image/webp",quality:1}))}return Promise.all(r)}).then(t=>{let e=b.get(s);void 0===e&&(e=new Map,b.set(s,e));var r=e.get(c);if(void 0!==r)for(var a of r.values())URL.revokeObjectURL(a);var i=new Map;for(let e=0;e<t.length;e++)i.set(d[e],URL.createObjectURL(t[e]));return i})},N=(e,t,r)=>{e=p(e),e=b.get(e);if(void 0!==e){var a=e.get(t);if(void 0!==a){for(var i of r)if(!1===a.has(i))return;return a}}},C=()=>{var e=n.data.item.metadata,e={Large:e.image_xlarge_url,Big:e.image_large_url,Default:e.image_url,Small:e.image_small_url};e.Default!==i?.Default&&(i=e,h.Fire())},w=()=>i,k=class{static findSetIndex(e){var t=k.ComponentClasses[e];for(let e=0;e<t.length;e++)if(document.body.querySelector("."+t[e]))return void(k.SetIndex=e)}static getComponent(e){return-1===k.SetIndex&&k.findSetIndex(e),document.body.querySelector("."+k.ComponentClasses[e][k.SetIndex])}static checkClassNamesMatch(e,t){-1===k.SetIndex&&k.findSetIndex(t);t=k.ComponentClasses[t][k.SetIndex];return e.contains(t)}},S=k,L=(S.ComponentClasses={FullScreenLyricsBackgroundClass:["lyrics-lyrics-background","o4GE4jG5_QICak2JK_bn","L9xhJOJnV2OL5Chm3Jew"],FullScreenLyricsContainerClass:["lyrics-lyrics-contentWrapper","_Wna90no0o0dta47Heiw","esRByMgBY3TiENAsbDHA"],SidebarLyricsBackgroundClass:["main-nowPlayingView-lyricsGradient","main-nowPlayingView-lyricsGradient","main-nowPlayingView-lyricsGradient"],LyricClass:["lyrics-lyricsContent-lyric","nw6rbs8R08fpPn7RWW2w","NiCdLCpp3o2z6nBrayOn"],UnsyncedLyricClass:["lyrics-lyricsContent-unsynced","SruqsAzX8rUtY2isUZDF","HxblHEsl2WX2yhubfVIc"],HighlightedLyricClass:["lyrics-lyricsContent-highlight","aeO5D7ulxy19q4qNBrkk","MEjuIn9iTBQbnCqHpkoQ"],ActiveLyricClass:["lyrics-lyricsContent-active","EhKgYshvOwpSrTv399Mw","arY01KDGhWNgzlAHlhpd"]},S.SetIndex=-1,S),A=[],x=function(e,t){return e=setTimeout(()=>{t()},1e3*e),A.push(e),function(e){clearTimeout(e);e=A.indexOf(e);-1<e&&A.splice(e,1)}.bind(null,e)},F=!1,_=[2,3],O=["lyrics-background-color","lyrics-background-back","lyrics-background-back-center"],U=[0,0,1],W=.25,M=t.AddSubCleanup(new e,"LiveMainBackgrounds"),E=t.AddSubCleanup(new e,"LiveSidebarBackgrounds"),q=e=>{let s=M.AddHtml(document.createElement("div")),n=(s.classList.add("lyrics-background-container"),[]);for(var t of O){var r=M.AddHtml(document.createElement("img"));r.classList.add(t),s.appendChild(r),n.push(r)}let o;if(F){let a=[],i=e=>{for(var[t,r]of n.entries())r.src=e?e.get(a[U[t]])??"MISSING":""},e=(o=()=>{let t=w();if(void 0===t)return i();for(var e of n)e.src=t.Default;var r=N(t,"LyricsPlusFullScreen",a);void 0===r?H(t,"LyricsPlusFullScreen",a).then(e=>{t===w()&&i(e)}):i(r)},()=>{var e,t=s.offsetWidth,r=[];for(e of _)r.push(Math.floor(t*e));a=r,o()});M.AddObserver(new ResizeObserver(()=>M.AddTask(x(W,e),"ContainerResize"))).observe(s),e()}else o=()=>{var e,t=w()?.Default??"";for(e of n)e.src=t};M.AddTask(h.Connect(o)),o();var a=()=>{e.classList.contains("lyrics-background")||e.classList.add("lyrics-background")};a(),M.AddObserver(new MutationObserver(a)).observe(e,{attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1}),e.prepend(s),M.AddTask(()=>e.classList.remove("lyrics-background"))},G=e=>{var t,r=E.AddHtml(document.createElement("div"));r.classList.add("lyrics-background-container"),r.style.zIndex="-1";let a=[];for(t of O){var i=E.AddHtml(document.createElement("img"));i.classList.add(t),r.appendChild(i),a.push(i)}var s=()=>{var e,t=w()?.Default??"";for(e of a)e.src=t},s=(E.AddTask(h.Connect(s)),s(),()=>{e.classList.contains("lyrics-background")||e.classList.add("lyrics-background")});e.style.position="relative",s(),E.AddObserver(new MutationObserver(s)).observe(e,{attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1}),e.prepend(r),E.AddTask(()=>{e.classList.remove("lyrics-background"),e.style.position=""})},P=null,T=null,V=()=>{var e=L.getComponent("FullScreenLyricsBackgroundClass");P!==e&&(null===e?(P=null,M.Clean()):((P=e).style.background="linear-gradient(90deg, #0a0a0a8a, #0000)",q(e?.parentElement?.parentElement?.parentElement?.parentElement?.parentElement?.parentElement?.querySelector(".under-main-view"))))},Y=()=>{var e=L.getComponent("SidebarLyricsBackgroundClass");T!==e&&(null===e?(T=null,E.Clean()):G(T=e))},B=()=>{V(),Y()},j=4,K=.5,J=.25,Q=.005,D=t.AddSubCleanup(new e,"Lyrics"),X=i=>{let n=new Map,s=0,o=(e,t)=>{e.style.fontSize="Active"==t.State?s+K+"rem":""},e=()=>{let t=0;for(var[e,r]of n){e=e.classList;L.checkClassNamesMatch(e,"ActiveLyricClass")?(r.State="Active",t=r.LayoutOrder):L.checkClassNamesMatch(e,"UnsyncedLyricClass")?r.State="Unsynced":L.checkClassNamesMatch(e,"HighlightedLyricClass")?r.State="Sung":r.State="Unsung"}for(var[a,i]of n){var s="Active"===i.State||"Unsynced"===i.State;let e;e=s||t<=1?0:Math.min(Math.abs(i.LayoutOrder-t),j);s=s?"var(--lyrics-color-active)":"Sung"===i.State?"var(--lyrics-color-passed)":"var(--lyrics-color-inactive)";o(a,i),a.style.color="transparent",a.style.textShadow=`0 0 ${e}px `+s}},t=()=>{var e,t,r=getComputedStyle(i),a=getComputedStyle(document.documentElement),r=parseFloat(r.fontSize),a=parseFloat(a.fontSize);s=r/a;for([e,t]of n)o(e,t)};var r,a,l;for(r of i.childNodes)r instanceof HTMLDivElement&&L.checkClassNamesMatch(r.classList,"LyricClass")&&(a=r,l=void 0,l=Array.from(i.children).indexOf(a),D.AddObserver(new MutationObserver(()=>D.AddTask(x(Q,e),"LyricUpdate"))).observe(a,{attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1}),n.set(a,{LayoutOrder:l,State:"Unsung"}));D.AddObserver(new ResizeObserver(()=>D.AddTask(x(J,t),"ContainerResize"))).observe(document.body),t(),e()},I=null,R=()=>{var e=L.getComponent("FullScreenLyricsContainerClass");I!==e&&(I=null,D.Clean(),e)&&X(I=e)},$=async function(){for(;!s&&!f();)await new Promise(e=>setTimeout(e,100));var e;r||(t.AddTask(m.SongChanged.Connect(C)),C(),m.Start(),t.AddObserver(new MutationObserver(()=>{B(),R()})).observe(document.body,{attributes:!1,childList:!0,subtree:!0}),(e=document.querySelector("#lyrics-cinema"))?.style.setProperty("grid-area","main-view / main-view / main-view / right-sidebar"),e?.style.setProperty("overflow","hidden"),B(),t.AddTask(m.SongChanged.Connect(()=>I=null)),R())};(async()=>{await $()})(),(async()=>{var e;document.getElementById("simpleDbeautifulDlyrics")||((e=document.createElement("style")).id="simpleDbeautifulDlyrics",e.textContent=String.raw`
  .lyrics-lyricsContent-lyric:hover{text-shadow:0 0 0 var(--lyrics-color-active)!important}.lyrics-lyricsContent-lyric{--lyrics-color-inactive:rgb(240 240 240 / 51%)!important}.nw6rbs8R08fpPn7RWW2w:hover{text-shadow:0 0 0 var(--lyrics-color-active)!important}.nw6rbs8R08fpPn7RWW2w{--lyrics-color-inactive:rgb(240 240 240 / 51%)!important}.NiCdLCpp3o2z6nBrayOn:hover{text-shadow:0 0 0 var(--lyrics-color-active)!important}.NiCdLCpp3o2z6nBrayOn{--lyrics-color-inactive:rgb(240 240 240 / 51%)!important}.lyrics-lyricsContent-active{margin-top:.25em;margin-bottom:.25em}.EhKgYshvOwpSrTv399Mw{margin-top:.25em;margin-bottom:.25em}.arY01KDGhWNgzlAHlhpd{margin-top:.25em;margin-bottom:.25em}.Root__main-view:has(.lyrics-background) .os-scrollbar,.os-host:has(.lyrics-background) .os-scrollbar{padding:5px}.Root__main-view:has(.lyrics-background) .os-scrollbar .os-scrollbar-handle,.os-host:has(.lyrics-background) .os-scrollbar .os-scrollbar-handle{mix-blend-mode:overlay;background-color:rgba(252,249,249,.117)!important}.lyrics-background{overflow:hidden;position:static}.lyrics-background-container{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden;filter:saturate(1.5) brightness(.8)}.lyrics-background-back,.lyrics-background-back-center,.lyrics-background-color{position:absolute;width:200%;animation:rotate 35s linear infinite;filter:blur(40px);border-radius:100em}.lyrics-background-color{right:0;top:0;z-index:10}.lyrics-background-back{left:0;bottom:0;z-index:1;animation-direction:reverse}.lyrics-background-back-center{z-index:0;width:300%;right:-50%;top:-20%;animation-direction:reverse}@keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}:root{--beautiful-lyrics-random-degree:258deg}@keyframes rotate{0%{transform:rotate(var(--beautiful-lyrics-random-degree))}100%{transform:rotate(calc(var(--beautiful-lyrics-random-degree) + 360deg))}}@font-face{font-family:BeautifulLyrics;font-weight:400;src:url(https://fonts.socalifornian.live/LyricsRegular.woff2) format("woff2")}@font-face{font-family:BeautifulLyrics;font-weight:500;src:url(https://fonts.socalifornian.live/LyricsMedium.woff2) format("woff2")}@font-face{font-family:BeautifulLyrics;font-weight:600;src:url(https://fonts.socalifornian.live/LyricsSemibold.woff2) format("woff2")}@font-face{font-family:BeautifulLyrics;font-weight:700;src:url(https://fonts.socalifornian.live/LyricsBold.woff2) format("woff2")}.main-nowPlayingView-lyricsContent .lyrics-lyricsContent-lyric{font-weight:700}.lyrics-lyricsContent-lyric:hover{text-decoration:none!important}.lyrics-lyricsContent-text{font-family:BeautifulLyrics,var(--encore-body-font-stack, var(--fallback-fonts, sans-serif)),sans-serif!important}
      `.trim(),document.head.appendChild(e))})()})();